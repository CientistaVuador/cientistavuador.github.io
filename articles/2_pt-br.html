<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <title>Metadados de Campo Zero - Adicionando metadados em seus arquivos CSV</title>
        
        <!-- HTML Meta Tags -->
        <meta charset="UTF-8"/>
        <meta name="keywords" content="caracteres, possui, bastante, escapada, aos, gigabytes, programa, estranho, grandes, adicionarem, menos, aceita, ter, github, criar, preservar, permite, estou, mestre, tornar, extend, pessoas, junto, está, meta, sua, seus, vida, deles, transformam, feito, curvadas, mim, dobrada, desse, si, sei, escrevendo, fato, embedded, key, comecei, principais, pequenos, riscos, texto, txt, coisas, alguns, escapado, tl, processamento, precisaria, diabo, pulo, da, comum, tr, sufixo, compatibilidade, consiga, mudaram, nível, lugar"/>
        <meta name="description" content="Esse artigo fala sobre adicionar metadados em seus arquivos CSV enquanto mantém compatibilidade com a RFC4180."/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        
        <link rel="icon" type="image/x-icon" href="/data/icon.png"/>
        <link rel="stylesheet" type="text/css" href="/data/style.css"/>
        <!-- HTML Meta Tags -->
        
        <!-- OpenGraph -->
        <meta name="og:title" content="Metadados de Campo Zero - Adicionando metadados em seus arquivos CSV"/>
        <meta name="og:description" content="Esse artigo fala sobre adicionar metadados em seus arquivos CSV enquanto mantém compatibilidade com a RFC4180."/>
        <meta name="og:type" content="article"/>
        <meta name="og:image" content="/data/icon.png"/>
        <!-- OpenGraph -->
    </head>
    <!--
    
    This is free and unencumbered software released into the public domain.
    
    Anyone is free to copy, modify, publish, use, compile, sell, or
    distribute this software, either in source code form or as a compiled
    binary, for any purpose, commercial or non-commercial, and by any
    means.
    
    In jurisdictions that recognize copyright laws, the author or authors
    of this software dedicate any and all copyright interest in the
    software to the public domain. We make this dedication for the benefit
    of the public at large and to the detriment of our heirs and
    successors. We intend this dedication to be an overt act of
    relinquishment in perpetuity of all present and future rights to this
    software under copyright law.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
    IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR
    OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
    ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.
    
    For more information, please refer to <http://unlicense.org/>
    
    pt-br
        Metadados de Campo Zero - Adicionando metadados em seus arquivos CSV
        Esse artigo fala sobre adicionar metadados em seus arquivos CSV enquanto mantém compatibilidade com a RFC4180.
        2
        2024/10/01 01:10
    
    -->
    <body class="body">
        <header class="header">
            <h1>Metadados de Campo Zero - Adicionando metadados em seus arquivos CSV</h1>
            <h2>Esse artigo fala sobre adicionar metadados em seus arquivos CSV enquanto mantém compatibilidade com a RFC4180.</h2>
            <h3>0002</h3>
            <h3>2024/10/01 01:10</h3>
            <h4><a href="2_en-us.html">EN-US</a> | <a href="2_pt-br.html">PT-BR</a></h4>
        </header>
        <main class="article">
            <nav class="indices">
                <ol>
                    <li><a href="#1+TL%3BDR">1 TL;DR</a></li>
                    <li><a href="#2+Introdu%C3%A7%C3%A3o">2 Introdução</a></li>
                    <li><a href="#3+Alternativas">3 Alternativas</a></li>
                    <li>
                        <ol>
                            <li><a href="#3.1+%23+como+coment%C3%A1rios+ou+metadados">3.1 # como comentários ou metadados</a></li>
                            <li><a href="#3.2+Arquivo+de+metadados%2FArquivo+Zip">3.2 Arquivo de metadados/Arquivo Zip</a></li>
                            <li><a href="#3.3+W3C">3.3 W3C</a></li>
                            <li><a href="#3.4+Refer%C3%AAncias+%28em+ingl%C3%AAs%29">3.4 Referências (em inglês)</a></li>
                        </ol>
                    </li><li><a href="#4+Minha+alternativa">4 Minha alternativa</a></li>
                    <li>
                        <ol>
                            <li><a href="#4.1+Campo+Zero">4.1 Campo Zero</a></li>
                            <li><a href="#4.2+Sem+outros+formatos+de+dados">4.2 Sem outros formatos de dados</a></li>
                            <li><a href="#4.3+Identific%C3%A1vel">4.3 Identificável</a></li>
                            <li><a href="#4.4+Identifica%C3%A7%C3%A3o+dos+dados+CSV">4.4 Identificação dos dados CSV</a></li>
                            <li><a href="#4.5+Valor+do+Campo+Zero">4.5 Valor do Campo Zero</a></li>
                            <li><a href="#4.6+Compatibilidade">4.6 Compatibilidade</a></li>
                            <li><a href="#4.7+Coment%C3%A1rios+de+uma+ou+mais+linhas+e+pulo+de+linhas">4.7 Comentários de uma ou mais linhas e pulo de linhas</a></li>
                        </ol>
                    </li><li><a href="#5+Em+c%C3%B3digo">5 Em código</a></li>
                    <li>
                        <ol>
                            <li><a href="#5.1+Lendo">5.1 Lendo</a></li>
                            <li><a href="#5.2+Escrevendo">5.2 Escrevendo</a></li>
                        </ol>
                    </li><li><a href="#6+Riscos+de+seguran%C3%A7a">6 Riscos de segurança</a></li>
                    <li><a href="#7+Em+editores+externos">7 Em editores externos</a></li>
                    <li>
                        <ol>
                            <li><a href="#7.1+Google+Sheets">7.1 Google Sheets</a></li>
                            <li><a href="#7.2+LibreOffice">7.2 LibreOffice</a></li>
                            <li><a href="#7.3+Excel">7.3 Excel</a></li>
                            <li><a href="#7.4+Outros+Editores+Online">7.4 Outros Editores Online</a></li>
                        </ol>
                    </li>
                </ol>
            </nav>
            <section id="1+TL%3BDR">
                <h2>1 TL;DR</h2>
                <p class="text">
                    Use o primeiro campo para propósitos de metadados, com um csv embutido começando
                    com csv-metadata-key,csv-metadata-value como o cabeçalho, defina csv-type-name
                    se você quiser definir o tipo do seu csv e csv-field-zero se quiser definir
                    o valor do primeiro campo (o campo índice zero) e use chaves vazias como
                    comentários ou para pular uma linha e tome cuidado com aspas duplas, já que
                    uma aspas duplas agora são duas e uma aspas duplas escapada agora são quatro.
                </p>
                <ol class="code">
                    <li><code>&quot;csv-metadata-key,csv-metadata-value</code></li>
                    <li><code>csv-type-name,vectors</code></li>
                    <li><code>csv-field-zero,x</code></li>
                    <li><code>,</code></li>
                    <li><code>,&quot;&quot;</code></li>
                    <li><code>Isso é um comentário</code></li>
                    <li><code>&quot;&quot;</code></li>
                    <li><code>,</code></li>
                    <li><code>chave,valor</code></li>
                    <li><code>chave,&quot;&quot;valor&quot;&quot;</code></li>
                    <li><code>outraChave,&quot;&quot;valor com &quot;&quot;&quot;&quot;aspas duplas&quot;&quot;&quot;&quot;!&quot;&quot;</code></li>
                    <li><code>&quot;,y,z</code></li>
                    <li><code>1,2,3</code></li>
                    <li><code>4,5,6</code></li>
                    <li><code>7,8,9</code></li>
                </ol>
            </section>
            <section id="2+Introdu%C3%A7%C3%A3o">
                <h2>2 Introdução</h2>
                <p class="text">
                    Esse artigo assume que a <a target="_blank" href="https://www.ietf.org/rfc/rfc4180.txt">RFC4180</a> é
                    o jeito certo de escrever e ler arquivos CSV.
                </p>
                <p class="text">
                    Na internet você pode encontrar vários jeitos de adicionar metadados para um arquivo csv, alguns
                    deles transformam seu csv em formatos proprietários que apenas o seu programa pode entender
                    enquanto outros precisam de arquivos adicionais, arquivos zip ou outros formatos de dados
                    como JSON ou XML, nesse artigo eu proponho um método para adicionar metadados para
                    arquivos csv.
                </p>
            </section>
            <section id="3+Alternativas">
                <h2>3 Alternativas</h2>
                <section id="3.1+%23+como+coment%C3%A1rios+ou+metadados">
                    <h3>3.1 # como comentários ou metadados</h3>
                    <p class="text">
                        Esse parece ser o jeito mais comum de adicionar metadados ou comentários para um csv, ele requer
                        um parser customizado ou pré-processamento, não possui padrão e pode ser meio ambíguo
                        já que um campo começando com # também pode ser um campo válido.
                    </p>
                    <ol class="code">
                        <li><code>#Isso é meu arquivo csv!</code></li>
                        <li><code>#tipo=vetores</code></li>
                        <li><code>x,y,z</code></li>
                        <li><code>1,2,3</code></li>
                        <li><code>4,5,6</code></li>
                        <li><code>7,8,9</code></li>
                    </ol>
                </section>
                <section id="3.2+Arquivo+de+metadados%2FArquivo+Zip">
                    <h3>3.2 Arquivo de metadados/Arquivo Zip</h3>
                    <p class="text">
                        Um arquivo para propósitos de metadados é carregado junto com o arquivo csv
                        normalmente com o mesmo nome do arquivo csv mais um sufixo (-meta.tipo) e
                        usa qualquer formato de dados, ambos os arquivos podem ser juntados
                        em um arquivo zip.
                    </p>
                    <ol class="code">
                        <li><code>meu-csv.csv:</code></li>
                        <li><code>x,y,z</code></li>
                        <li><code>1,2,3</code></li>
                        <li><code>4,5,6</code></li>
                        <li><code>7,8,9</code></li>
                        <li><code></code></li>
                        <li><code>meu-csv-meta.xml:</code></li>
                        <li><code>&lt;meta&gt;</code></li>
                        <li><code>    &lt;descricao&gt;Isso é meu arquivo csv!&lt;/descricao&gt;</code></li>
                        <li><code>    &lt;tipo&gt;vetores&lt;/tipo&gt;</code></li>
                        <li><code>&lt;/meta&gt;</code></li>
                        <li><code></code></li>
                        <li><code>meu-csv.zip:</code></li>
                        <li><code>    meu-csv.csv</code></li>
                        <li><code>    meu-csv-meta.xml</code></li>
                    </ol>
                </section>
                <section id="3.3+W3C">
                    <h3>3.3 W3C</h3>
                    <p class="text">
                        Eles <a target="_blank" href="https://www.w3.org/TR/tabular-data-model/#embedded-metadata">tentaram</a> (em inglês),
                        eu nunca ouvi falar desse formato da W3C até que comecei a pesquisar sobre metadados
                        em arquivos csv.
                    </p>
                    <ol class="code">
                        <li><code>#publisher,W3C</code></li>
                        <li><code>#updated,2015-10-17T00:00:00Z</code></li>
                        <li><code>#name,sensor,temperature</code></li>
                        <li><code>#datatype,string,float</code></li>
                        <li><code>sensor,temperature</code></li>
                        <li><code>s-1,25.5</code></li>
                    </ol>
                </section>
                <section id="3.4+Refer%C3%AAncias+%28em+ingl%C3%AAs%29">
                    <h3>3.4 Referências (em inglês)</h3>
                    <ul class="list">
                        <li><p><a target="_blank" href="https://stackoverflow.com/questions/18362864/adding-metadata-identifier-data-to-a-csv-file">Adding metadata / identifier data to a CSV file?</a></p></li>
                        <li><p><a target="_blank" href="https://stackoverflow.com/questions/30739931/store-metadata-in-csv-file">Store metadata in CSV file</a></p></li>
                        <li><p><a target="_blank" href="https://stackoverflow.com/questions/58987503/how-to-add-metadata-to-a-csv-file">How to add metadata to a csv file?</a></p></li>
                        <li><p><a target="_blank" href="https://gist.github.com/seece/97d02d6518db8b9e4c5b81fc686553e2">A Straightforward Way To Extend CSV With Metadata</a></p></li>
                    </ul>
                </section>
            </section>
            <section id="4+Minha+alternativa">
                <h2>4 Minha alternativa</h2>
                <p class="text">
                    Então, se queremos adicionar metadados em nossos arquivos csv, ele deve continuar
                    sendo um único arquivo csv, ele não deve usar outros formatos de dados, ele deve
                    ser compatível com um parser que consiga ler RFC4180, ele tem que ser identificável
                    e simples o bastante para que as pessoas considerem o seu uso.
                </p>
                <section id="4.1+Campo+Zero">
                    <h3>4.1 Campo Zero</h3>
                    <p class="text">
                        Depois de pensar sobre, não há melhor lugar
                        para adicionar metadados do que se não
                        no primeiro campo do arquivo csv.
                    </p>
                    <ol class="code">
                        <li><code>&quot;metadados&quot;,y,z</code></li>
                        <li><code>1,2,3</code></li>
                        <li><code>4,5,6</code></li>
                        <li><code>7,8,9</code></li>
                    </ol>
                </section>
                <section id="4.2+Sem+outros+formatos+de+dados">
                    <h3>4.2 Sem outros formatos de dados</h3>
                    <p class="text">
                        Ao invés de usar outros formatos de dados como json ou xml, nós
                        usamos um csv embutido para isso, isso elimina o requerimento para
                        outros formatos de dados.
                    </p>
                    <ol class="code">
                        <li><code>&quot;a,b,c,d&quot;,y,z</code></li>
                        <li><code>1,2,3</code></li>
                        <li><code>4,5,6</code></li>
                        <li><code>7,8,9</code></li>
                    </ol>
                </section>
                <section id="4.3+Identific%C3%A1vel">
                    <h3>4.3 Identificável</h3>
                    <p class="text">
                        Nós usamos um cabeçalho de csv para isso que só pode ter uma chave e um valor,
                        qualquer outro cabeçalho não é válido e deve ser processado como um campo
                        normal, mesmo que o cabeçalho seja meio único, ainda é uma boa ideia
                        para os parsers adicionarem uma opção para ler como texto ao invés de metadados,
                        redefinição de campos é permitida e é feita na ordem de aparição, como isso é um
                        arquivo csv embutido, aspas duplas devem ser escritas como duas ao invés de uma
                        e quatro ao invés de duas dentro de campos com aspas duplas.
                    </p>
                    <ol class="code">
                        <li><code>&quot;csv-metadata-key,csv-metadata-value</code></li>
                        <li><code>a,10</code></li>
                        <li><code>b,20</code></li>
                        <li><code>x,&quot;&quot;campo, com, vírgulas&quot;&quot;</code></li>
                        <li><code>y,&quot;&quot;campo com &quot;&quot;&quot;&quot;aspas duplas&quot;&quot;&quot;&quot;!&quot;&quot;</code></li>
                        <li><code>c,30</code></li>
                        <li><code>c,40</code></li>
                        <li><code>&quot;,y,z</code></li>
                        <li><code>1,2,3</code></li>
                        <li><code>4,5,6</code></li>
                        <li><code>7,8,9</code></li>
                    </ol>
                </section>
                <section id="4.4+Identifica%C3%A7%C3%A3o+dos+dados+CSV">
                    <h3>4.4 Identificação dos dados CSV</h3>
                    <p class="text">
                        Nós adicionamos um opcional &quot;csv-type-name&quot; para identificação
                        de tipos, similar aos namespaces de XML, isso permite que um
                        arquivo csv seja facilmente distinguível de outro, assim como é
                        pra XML eu recomendo usar uma URL para isso mas qualquer string
                        é válida, até uma vazia ou nada.
                    </p>
                    <ol class="code">
                        <li><code>&quot;csv-metadata-key,csv-metadata-value</code></li>
                        <li><code>csv-type-name,https://example.com/vectors.txt</code></li>
                        <li><code>&quot;,y,z</code></li>
                        <li><code>1,2,3</code></li>
                        <li><code>4,5,6</code></li>
                        <li><code>7,8,9</code></li>
                    </ol>
                </section>
                <section id="4.5+Valor+do+Campo+Zero">
                    <h3>4.5 Valor do Campo Zero</h3>
                    <p class="text">
                        Nós adicionamos um opcional &quot;csv-field-zero&quot; para definir
                        o valor do campo zero (o primeiro campo), se não presente
                        uma string vazia é assumida.
                    </p>
                    <ol class="code">
                        <li><code>&quot;csv-metadata-key,csv-metadata-value</code></li>
                        <li><code>csv-type-name,https://example.com/vectors.txt</code></li>
                        <li><code>csv-field-zero,x</code></li>
                        <li><code>&quot;,y,z</code></li>
                        <li><code>1,2,3</code></li>
                        <li><code>4,5,6</code></li>
                        <li><code>7,8,9</code></li>
                    </ol>
                </section>
                <section id="4.6+Compatibilidade">
                    <h3>4.6 Compatibilidade</h3>
                    <p class="text">
                        Se é necessário manter compatível com um sistema, podemos
                        mover todos os dados para a direita e remover o &quot;csv-field-zero&quot;,
                        isso não afeta nada, altera apenas a estrutura do csv em si
                        e faz o cabeçalho reaparecer corretamente novamente.
                    </p>
                    <ol class="code">
                        <li><code>&quot;csv-metadata-key,csv-metadata-value</code></li>
                        <li><code>csv-type-name,https://example.com/vectors.txt</code></li>
                        <li><code>&quot;,x,y,z</code></li>
                        <li><code>,1,2,3</code></li>
                        <li><code>,4,5,6</code></li>
                        <li><code>,7,8,9</code></li>
                    </ol>
                </section>
                <section id="4.7+Coment%C3%A1rios+de+uma+ou+mais+linhas+e+pulo+de+linhas">
                    <h3>4.7 Comentários de uma ou mais linhas e pulo de linhas</h3>
                    <p class="text">
                        O Fato de que permitimos a redefinição de campos significa que agora
                        podemos utilizar chaves vazias como comentários de uma ou mais linhas ou
                        para pular linhas, cuidado deve ser tomado com as aspas duplas, já
                        que isso ainda é um campo normal.
                    </p>
                    <ol class="code">
                        <li><code>&quot;csv-metadata-key,csv-metadata-value</code></li>
                        <li><code>csv-type-name,https://example.com/vectors.txt</code></li>
                        <li><code>,</code></li>
                        <li><code>,Comentário de uma linha!</code></li>
                        <li><code>,</code></li>
                        <li><code>,&quot;&quot;</code></li>
                        <li><code>Isso é</code></li>
                        <li><code>um comentário</code></li>
                        <li><code>de várias linhas!</code></li>
                        <li><code>&quot;&quot;</code></li>
                        <li><code>&quot;,x,y,z</code></li>
                        <li><code>,1,2,3</code></li>
                        <li><code>,4,5,6</code></li>
                        <li><code>,7,8,9</code></li>
                    </ol>
                </section>
            </section>
            <section id="5+Em+c%C3%B3digo">
                <h2>5 Em código</h2>
                <p class="text">
                    Escrever e ler se torna bem simples, o parser de CSV que estou usando
                    foi feito por mim mesmo com menos de 100 linhas, que é uma das
                    principais vantagens de CSV, a classe aceita valores null como strings
                    vazias.
                </p>
                <section id="5.1+Lendo">
                    <h3>5.1 Lendo</h3>
                    <ol class="code">
                        <li><code>CSV csv = CSV.read(...);</code></li>
                        <li><code></code></li>
                        <li><code>String keyHeader = &quot;csv-metadata-key&quot;;</code></li>
                        <li><code>String valueHeader = &quot;csv-metadata-value&quot;;</code></li>
                        <li><code>String header = keyHeader + &quot;,&quot; + valueHeader;</code></li>
                        <li><code>String quotedHeader = &quot;\&quot;&quot; + keyHeader + &quot;\&quot;,\&quot;&quot; + valueHeader + &quot;\&quot;&quot;;</code></li>
                        <li><code></code></li>
                        <li><code>Map&lt;String, String&gt; metadata = new LinkedHashMap&lt;&gt;();</code></li>
                        <li><code>String fieldZero = csv.get(0, 0);</code></li>
                        <li><code></code></li>
                        <li><code>//cheque se o campo começa com o cabeçalho</code></li>
                        <li><code>if (fieldZero.startsWith(header) || fieldZero.startsWith(quotedHeader)) {</code></li>
                        <li><code></code></li>
                        <li><code>    //leia os metadados como csv e cheque se o cabeçalho é válido</code></li>
                        <li><code>    CSV csvMetadata = CSV.read(fieldZero);</code></li>
                        <li><code>    if (csvMetadata.getNumberOfFields() == 2</code></li>
                        <li><code>            &amp;&amp; csvMetadata.get(0, 0).equals(keyHeader)</code></li>
                        <li><code>            &amp;&amp; csvMetadata.get(1, 0).equals(valueHeader)</code></li>
                        <li><code>            ) {</code></li>
                        <li><code></code></li>
                        <li><code>        //leia os metadados, ignorando o cabeçalho</code></li>
                        <li><code>        for (int metaRecord = 1; metaRecord &lt; csvMetadata.getNumberOfRecords(); metaRecord++) {</code></li>
                        <li><code>            String k = csvMetadata.get(0, metaRecord);</code></li>
                        <li><code>            String v = csvMetadata.get(1, metaRecord);</code></li>
                        <li><code>            //remove comentários</code></li>
                        <li><code>            if (k.isEmpty()) {</code></li>
                        <li><code>                continue;</code></li>
                        <li><code>            }</code></li>
                        <li><code>            metadata.put(k, v);</code></li>
                        <li><code>        }</code></li>
                        <li><code></code></li>
                        <li><code>        //define o campo zero</code></li>
                        <li><code>        csv.set(0, 0, metadata.get(&quot;csv-field-zero&quot;));</code></li>
                        <li><code>    }</code></li>
                        <li><code>}</code></li>
                        <li><code>System.out.println(&quot;Type: &quot;+metadata.get(&quot;csv-type-name&quot;));</code></li>
                        <li><code>System.out.println(&quot;Field zero: &quot;+csv.get(0, 0));</code></li>
                    </ol>
                </section>
                <section id="5.2+Escrevendo">
                    <h3>5.2 Escrevendo</h3>
                    <ol class="code">
                        <li><code>CSV csv = CSV.read(...);</code></li>
                        <li><code></code></li>
                        <li><code>String keyHeader = &quot;csv-metadata-key&quot;;</code></li>
                        <li><code>String valueHeader = &quot;csv-metadata-value&quot;;</code></li>
                        <li><code>...</code></li>
                        <li><code>Map&lt;String, String&gt; metadata = new LinkedHashMap&lt;&gt;();</code></li>
                        <li><code>...</code></li>
                        <li><code></code></li>
                        <li><code>//define o campo zero</code></li>
                        <li><code>metadata.put(&quot;csv-field-zero&quot;, csv.get(0, 0));</code></li>
                        <li><code></code></li>
                        <li><code>//cria um novo csv com o tamanho de metadata mais 1</code></li>
                        <li><code>CSV csvMetadata = new CSV(null, 2, metadata.size() + 1);</code></li>
                        <li><code></code></li>
                        <li><code>//escreve o cabeçalho</code></li>
                        <li><code>csvMetadata.set(0, 0, keyHeader);</code></li>
                        <li><code>csvMetadata.set(1, 0, valueHeader);</code></li>
                        <li><code></code></li>
                        <li><code>//escreve o metadata</code></li>
                        <li><code>int index = 1;</code></li>
                        <li><code>for (Map.Entry&lt;String, String&gt; e:metadata.entrySet()) {</code></li>
                        <li><code>    csvMetadata.set(0, index, e.getKey());</code></li>
                        <li><code>    csvMetadata.set(1, index, e.getValue());</code></li>
                        <li><code>    index++;</code></li>
                        <li><code>}</code></li>
                        <li><code></code></li>
                        <li><code>//escreve a saída no campo zero</code></li>
                        <li><code>csv.set(0, 0, csvMetadata.toString());</code></li>
                        <li><code>System.out.println(csv.toString());</code></li>
                    </ol>
                </section>
            </section>
            <section id="6+Riscos+de+seguran%C3%A7a">
                <h2>6 Riscos de segurança</h2>
                <p class="text">
                    Embutir CSVs dentro de CSVs pode se tornar um potencial vetor
                    de ataque DoS por causa de como as aspas duplas são escapadas, para
                    cada nível de profundidade a quantidade de aspas duplas necessárias
                    é dobrada, na profundidade 32, a quantidade necessária de aspas duplas
                    para uma única aspas duplas precisaria de gigabytes de caracteres
                    para escapar ela.
                </p>
                <p class="text">
                    Se você realmente precisa embutir múltiplos CSVs dentro de um arquivo
                    CSV sem arquivos adicionais, o melhor jeito seria criar um file system
                    com um arquivo zip, escrever todos os seus CSVs nele e então embutir
                    o zip como base64 em um csv mestre, cuidado deve ser tomado
                    já que zip bombs ainda são uma possibilidade.
                </p>
                <ol class="code">
                    <li><code>&quot;csv-metadata-key,csv-metadata-value</code></li>
                    <li><code>csv-type-name,https://example.com/vectors.txt</code></li>
                    <li><code>meusOutrosCsvsDados,c2Rmc2Rmc2Rmc2RmZXdyZXdyY2J2eHZuY2ZqbnRyeXVqdHk3aTZ5dWtqaGcsbWd2bnZjYnhjdmFzZFFFVw==</code></li>
                    <li><code>meusOutrosCsvsRaiz,raiz.csv</code></li>
                    <li><code>&quot;,x,y,z</code></li>
                    <li><code>,1,2,3</code></li>
                    <li><code>,4,5,6</code></li>
                    <li><code>,7,8,9</code></li>
                </ol>
            </section>
            <section id="7+Em+editores+externos">
                <h2>7 Em editores externos</h2>
                <p class="text">
                    Se corretamente escapado, qualquer editor que suporte a RFC4180 deve
                    conseguir ler e preservar os metadados.
                </p>
                <section id="7.1+Google+Sheets">
                    <h3>7.1 Google Sheets</h3>
                    <p class="text">
                        Google Sheets foi o melhor, parece seguir
                        a RFC4180 em importar e exportar arquivos csv.
                    </p>
                </section>
                <section id="7.2+LibreOffice">
                    <h3>7.2 LibreOffice</h3>
                    <p class="text">
                        LibreOffice conseguiu importar/exportar corretamente mas
                        ele tem um estranho comportamento de trocar aspas duplas
                        por aspas duplas curvadas no editor e a falta de um scroll
                        suave torna chata a edição de grandes campos de metadados.
                    </p>
                </section>
                <section id="7.3+Excel">
                    <h3>7.3 Excel</h3>
                    <p class="text">
                        Excel nunca suportou a RFC4180 até onde eu sei, se
                        as coisas não mudaram, excel ainda deve ser o diabo dos
                        arquivos csv, gerando arquivos diferentes que dependem
                        de qual país você está, garantindo que sua vida como
                        programador será dolorida.
                    </p>
                </section>
                <section id="7.4+Outros+Editores+Online">
                    <h3>7.4 Outros Editores Online</h3>
                    <p class="text">
                        Eu consegui encontrar vários editores online pequenos
                        de arquivos csv, todos os que eu testei parecem
                        seguir a RFC4180.
                    </p>
                </section>
            </section>
        </main>
        <footer class="footer">
            <p><a href="articles_pt-br.html">&lt;&lt;&lt; Retornar para Artigos</a></p>
            <script src="https://utteranc.es/client.js"
                    repo="CientistaVuador/cientistavuador.github.io"
                    issue-term="Article 2"
                    label="comments"
                    theme="github-dark"
                    crossorigin="anonymous"
                    async="async"
                    >
            </script>
            <p>A Licença desta página pode ser encontrada no código-fonte ou no <a target="_blank" href="https://github.com/CientistaVuador/cientistavuador.github.io">repositório do github</a>.</p>
        </footer>
    </body>
</html>